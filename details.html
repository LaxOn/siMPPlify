<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>siMPPlify</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/landing-page.css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  </head>

  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-light bg-color">
      <a class="navbar-brand" href="#">
        <img class="nav-logo" src="img/logo.png">
      </a>
        <div class="navbar-nav">
          <!-- Search form -->
          <form class="form-inline">
              <i class="fa fa-search" aria-hidden="true"></i>
              <input class="form-control form-control-sm ml-3 w-75" type="text" placeholder="Search" aria-label="Search">
          </form>
          <a class="nav-item nav-link nav-buttons" href="#">About</a>
          <a class="nav-item nav-link nav-buttons" href="#">Bills</a>
          <a class="nav-item nav-link nav-buttons" href="#">Contact</a>
        </div>
    </nav>

    <section class="issue-details">
      <div class="container">
        <div class="row">
          <div class="col-md-1">
            <img id="progressBar" src="img/progress-bar.png">
          </div>
          <div class="col-md-10">
            <h1 class="bill-title">Cap and Trade Cancellation Act</h1>
            <img src="img/tags.PNG">
            <h2 class="long-title">An Act respecting the preparation of a climate change plan, providing for the wind down of the cap and trade program and repealing the Climate Change Mitigation and Low-carbon Economy Act, 2016</h2>
            <p class="bill-summary">The Bill sets out the Cap and Trade Cancellation Act, 2018, which repeals the Climate Change Mitigation and Low-carbon Economy Act, 2016 and provides for various matters related to the wind down of the Cap and Trade Program. Under the Cap and Trade Cancellation Act, 2018, the Government is required to establish targets for reducing the amount of greenhouse gas emissions in Ontario.  The Minister of Environment, Conservation and Parks is required to prepare a climate change plan and to prepare progress reports in respect of the plan. <a href="https://www.ola.org/en/legislative-business/bills/parliament-42/session-1/bill-4">(Learn more...)</a></p>
            <p class="reading-stage">Stage: First Reading</p>
          </div>
        </div>
      </div>
    </section>



    <section class="agree-or-disagree">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <p id="agree-or-disagree">Do you agree or disagree with this Act?</p>
          </div>
          <div class = "col-md-6">
            <button type="button" class="button-background" onclick="showEmail(1)">Agree</button>
            <button type="button" class="button-background" onclick="showEmail(0)">Disagree</button>
          </div>
        </div>
      </div>
    </section>

<div id="hide-me">
    <!-- Take Action -->
  <div class="take-action">
    <!-- ask katie -->
    <h1 class="headings" id="take-action-title">TAKE ACTION</h1>

    <div class="row">
      <div class="col-lg-2"></div>
      <div class="col-lg-6" >
        <div class="mpp-form-text">
          <div class="mpp-custom-text">Write to your local Member of Provincial Parliament (MPP) to bring issues to their attention. Use our template or treat it as a jumping off point!</div>

          <label id="client-name-label" class="take-action-box-label">Name</label><br>
          <input id="client-name" type="text" name="clientName" required><br>
          <label class="take-action-box-label">Email</label><br>
          <input id="client-email"type="text" name="clientEmail" required><br>
          <label class="take-action-box-label">Message</label><br>
        </div>
      </div>

      <div class="col-lg-2">
        <!-- face changes -->
        <div class="crop">
          <img class="mpp-face" id="imageid" src="img/defaultmpp.jpeg">
        </div>
          <div id="mpp-info">
            <div class="mppTitle">Your Member of<br>Provincial Parliament:</div>
            <div class="mppMoreTitle" id="mppName"></div>
          </div>
      </div>

      <div class="col-lg-2"></div>
    </div>
    <div class="row">
      <div class="col-lg-2"></div>
      <div class="col-lg-8">
        <textarea id="custom-email"></textarea>
      </div>
      <div class="col-lg-2"></div>
    </div>
    <div class="row">
     <div class="col-lg-2"></div>
     <div class="col-lg-8">
      <!-- changes -->
      <label id="custom-email-guide">Dear MPP, I'm a small business owner of construction materials in the GTA. I'm concerned about how tariffs will impact trade across the border and the cost of goods...</label>
    </div>
    <div class="col-lg-2"></div>
  </div>
  <div class="submit-btn">
    <button type="button" class="button-background" data-toggle="modal" data-target="#submitModal" onclick="submitEmail()">Submit</button>
  </div>
  </div>
</div>

  <!-- Modal -->
<div class="modal fade" id="submitModal" tabindex="-1" role="dialog" aria-labelledby="submitModalLongTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-center" id="exampleModalLongTitle">SUCCESS!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Your letter to your MPP was sent. You should receive an email response within 14 days.</p>
        <img src="img/success.png" id="success-image">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



    <!-- Footer -->
    <footer class="footer bg-light">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 h-100 text-center text-lg-left my-auto">
            <ul class="list-inline mb-2">
              <li class="list-inline-item">
                <a href="#">About</a>
              </li>
              <li class="list-inline-item">&sdot;</li>
              <li class="list-inline-item">
                <a href="#">Contact</a>
              </li>
              <li class="list-inline-item">&sdot;</li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
              <li class="list-inline-item">&sdot;</li>
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
            </ul>
            <p class="text-muted small mb-4 mb-lg-0">&copy; Your Website 2018. All Rights Reserved.</p>
          </div>
          <div class="col-lg-6 h-100 text-center text-lg-right my-auto">
            <ul class="list-inline mb-0">
              <li class="list-inline-item mr-3">
                <a href="#">
                  <i class="fa fa-facebook fa-2x fa-fw"></i>
                </a>
              </li>
              <li class="list-inline-item mr-3">
                <a href="#">
                  <i class="fa fa-twitter fa-2x fa-fw"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fa fa-instagram fa-2x fa-fw"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->

    <div id="map"></div>
  <script src="findYourRep.js"></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD_Zkal7S_TNKKAhGs6FrwcyVEUx1ik91k&callback=initMap">
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script>
    $(function() {
      // Bind Click event to the drop down navigation button
      $(".nav-button").click(function() {
        /*  Toggle the CSS closed class which reduces the height of the UL thus
            hiding all LI apart from the first */
        $(this).parent().parent().toggleClass("closed");
      });

      });
    </script>

    <script type="text/javascript">
      function showEmail(isApprove) {
        document.getElementById("hide-me").style.visibility="visible"
        document.getElementById("hide-me").style.display="unset"

      let name = document.getElementById("mppName").innerHTML;
      let fullName = name.split(',')[0];
      let cName = document.getElementById("client-name").value;
      let cEmail = document.getElementById("client-email").value;
      let cMessage = document.getElementById("custom-email").value;
      let emailInfo = {
        isApprove: isApprove,
        mppName: fullName,
        billLongName: "An Act respecting the preparation of a climate change plan, providing for the wind down of the cap and trade program and repealing the Climate Change Mitigation and Low-carbon Economy Act, 2016",
        billShortName: "Cap and Trade Cancellation Act",
        clientName: cName,
        clientEmail: cEmail,
        mppEmail:"simpplify.ca@gmail.com",
        text: cMessage  
      }
      $.post("./processEmailBody",emailInfo, function(data, status){
        document.getElementById("custom-email").value = data
        document.getElementById("custom-email").style.height = "400px"
      });

      }
    </script>
    <script type="text/javascript">
      function submitEmail(info) {

        let name = document.getElementById("mppName").innerHTML;
        let fullName = name.split(',')[0];
        let cName = document.getElementById("client-name").value;
        let cEmail = document.getElementById("client-email").value;
        let cMessage = document.getElementById("custom-email").value;

        // if (typeof cName =="undefined" || cName.trim() =="" ||
        //   typeof cEmail =="undefined" || cEmail.trim() =="") {
        //   alert("Missing Name or Email parameter!")
        //   return
        // }

        let emailInfo = {
          mppName: fullName,
          billLongName: "An Act respecting the preparation of a climate change plan, providing for the wind down of the cap and trade program and repealing the Climate Change Mitigation and Low-carbon Economy Act, 2016",
          billShortName: "Cap and Trade Cancellation Act",
          clientName: cName,
          clientEmail: cEmail,
          mppEmail:"simpplify.ca@gmail.com",
          text: cMessage  
        }
         $.post("./sendMail",emailInfo, function(data, status){
            });
      }
    </script>

  </body>

</html>
